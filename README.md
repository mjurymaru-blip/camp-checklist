# 🏕️ Camp Checklist - キャンプ持ち物チェック

キャンプの持ち物を管理するためのPWA（Progressive Web App）です。
オフラインでも使用でき、スマートフォンにインストールして使えます。

## ✨ 機能

- **チェックリスト管理**: キャンプごとに持ち物リストを作成・管理
- **プリセットテンプレート**: ソロ / デュオ / ファミリー用のテンプレートから簡単にリスト作成
- **カテゴリ分類**: テント・寝具・調理器具・食材などカテゴリ別に整理
- **ドラッグ&ドロップ**: アイテムの並び順を直感的に変更可能
- **データバックアップ**: JSONファイルでのエクスポート/インポート機能
- **履歴管理**: 過去のキャンプリストをアーカイブとして保存
- **PWA対応**: オフライン利用、ホーム画面への追加が可能
- **ダークモード**: システム設定に追従、または手動でライト/ダーク切り替え
- **AIメニュー提案**: Gemini AIが手持ちのギアと季節に合わせてレシピを提案

## 🚀 デモ

GitHub Pages: https://mjurymaru-blip.github.io/camp-checklist/

## 📲 スマートフォンへのインストール

PWAとしてホーム画面に追加できます。

**Android (Chrome)**
1. 上記デモURLを開く
2. ブラウザメニュー（⋮）→「ホーム画面に追加」

**iPhone (Safari)**
1. 上記デモURLを開く
2. 共有ボタン（□↑）→「ホーム画面に追加」

インストール後はオフラインでも使用できます。

## 🛠️ 技術スタック

- React 18 + TypeScript
- Vite
- Zustand（状態管理）
- React Router
- @dnd-kit（ドラッグ&ドロップ）

## 📦 開発者向け

```bash
# 依存関係のインストール
npm install

# 開発サーバー起動
npm run dev

# 本番ビルド
npm run build

# テスト実行
npm run test
```

## 🧱 Architecture

このプロジェクトは、機能拡張に伴う保守性を考慮した設計になっています。

- **UIコンポーネントの分離**: 入力 / 選択 / 結果表示を責任ごとに分割
- **ビジネスロジックの抽出**: カスタムフックとサービスにロジックを集約
- **AI連携の隔離**: AI関連ロジックはUIコンポーネントから独立

メニュー提案機能は、お気に入り・履歴・カスタムレシピなどの将来拡張を見据えてモジュール化されています。

## 📦 Data Validation

レシピはJSONファイルとして管理され、動的にロードされます。

データセットが拡張しても安定性を保つため、全レシピデータはランタイムでスキーマバリデーションを実施しています。

- 不正なレシピは安全に除外
- 1件の不正データが全体を壊すことはない

これにより、300件以上のレシピデータを安心して拡張できます。

## 🧪 Testing

ユーザー体験とAPI利用に影響するコアロジックを中心にテストしています。

**カバー範囲:**
- レート制限ロジック
- ユーティリティ関数
- レシピデータバリデーション

UI動作は現段階では手動テストで確認しています。
プロジェクトの成長に伴い、自動テストを拡充予定です。

### 📂 レシピデータ構造
レシピデータは `public/recipes/` ディレクトリに分離されており、コードの変更なしにデータの更新が可能です。

```
public/recipes/
├── index.json       # 全レシピファイルのリスト
├── seafood.json     # シーフード系レシピ
├── meat.json        # 肉料理レシピ
└── ...
```

## 📱 使い方

### 基本操作

1. **新しいチェックリストを作成**: リスト画面の「＋」ボタンから作成
2. **テンプレートを選択**: ソロ / デュオ / ファミリーから選んですぐに開始
3. **アイテムをチェック**: キャンプ準備でアイテムをタップしてチェック
4. **並び替え**: アイテムをドラッグして好きな順番に変更
5. **バックアップ**: 設定画面からデータをJSONファイルに保存

### 便利な機能

#### リストからテンプレートを作成
自分用にカスタマイズしたリストをテンプレートとして保存できます。

1. チェックリスト画面で右上の「⋮」（三点メニュー）をタップ
2. 「📋 テンプレートとして保存」を選択
3. テンプレート名を入力して保存

#### 全選択 / 全解除
チェックリスト画面の「⋮」メニューから、全てのアイテムを一括でチェック/解除できます。

#### アイテムの編集・削除
アイテムをタップすると編集モードになり、名前・数量の変更や削除ができます。

#### テンプレートの共有
- **エクスポート**: テンプレート一覧で📤ボタン → JSONファイルをダウンロード
- **インポート**: テンプレート一覧で📥ボタン → JSONファイルを選択

#### 履歴リストの再利用
履歴タブのリストを開いて「🔄 再利用」をタップすると、リスト画面に戻せます。

#### 簡易スナップショット
設定画面でブラウザ内にデータを一時保存できます。誤操作時に素早く復元可能です。

> ⚠️ ブラウザのキャッシュ削除で消えます。確実な保存は「ファイルに保存」をご利用ください。

### 🍳 AIメニュー提案（Beta）

Gemini APIを利用して、あなたの状況（人数・季節など）と手持ちのギアに最適なキャンプ飯を提案します。

#### ✨ 特徴
- **スマート2段階提案**: まず「メインの料理（夕食など）」を決め、夕食のみで完了するか、食材や道具を使い回せるフルコース（朝/昼/つまみ）をAIが組み立てるかを選択できます。
- **クイックプリセット**: 「子連れ」「ソロ簡単」「冬あったか」などのワンタップ設定で素早くフィルター条件を切り替え。
- **柔軟な提案モード**: 夕食は「夕食のみ」または「フルコース提案」を選択可能。朝食・昼食は「単品提案」になります。
- **チェックリスト連携**: 提案されたレシピの食材をそのままチェックリストに追加可能。レシピごとに選択でき、食材のメモには「○○用」とレシピ名が付きます。
- **レシピ保存**: 追加した食材のレシピ（手順・Tips）はチェックリストに紐づいて保存され、買い物中やキャンプ場で確認できます。
- **2つの探し方**: 「✨ AIのおすすめ」で条件に合う5件提案、または「🔍 条件で探す」で内蔵レシピ（約300件）から検索。季節・難易度・食事タイプ・コスト・キーワードで絞り込み可能。
- **お気に入りレシピ**: 気に入ったレシピに⭐をつけて保存。タップで詳細を確認できます。
- **提案履歴**: AI提案の履歴を自動保存。過去のメニューを振り返れます。
- **ギアの考慮**: 「ダッチオーブンはあるけどスキレットはない」といった所持状況に合わせてレシピを選定します。
- **自動リトライ**: サーバー混雑時も自動で再接続を行い、安定した提案を実現します。

#### 🔑 利用方法
1. **APIキーの取得**: [Google AI Studio](https://aistudio.google.com/app/apikey) から無料のAPIキーを取得します。
2. **アプリ設定**: アプリの「レシピ」タブ → ⚙️設定からキーを入力します。
    - **モデル選択**: 自動で利用可能なモデル一覧を取得し、最適なモデル（`gemini-2.0-flash` など）を選択します。
    > [!IMPORTANT]
    > **セキュリティ上の注意**
    > APIキーはブラウザの `localStorage` にのみ保存され、外部サーバーには送信されません。
    > **ただし、ご自身のフォークリポジトリ等で設定を含んだバックアップデータをコミットしないよう十分ご注意ください。**

3. **提案**: 「レシピ」タブで人数や季節を選び、「おすすめしてもらう」または「自分で探す」をタップ！
4. **買い物リスト**: 提案結果から「📋 チェックリストに追加」→ レシピを選択 → 追加
5. **レシピ確認**: チェックリスト詳細画面で「🍳 レシピを見る」をタップすると調理手順を確認できます。

※ Gemini Free/Flashモデル（無料枠）で十分に動作します。

## ♿ アクセシビリティ

現在はタッチ操作に最適化しています。キーボード操作やスクリーンリーダー対応は今後の改善予定です。

## 📄 ライセンス

MIT License
